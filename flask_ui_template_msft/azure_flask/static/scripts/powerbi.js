// Read embed application token from textbox
var txtAccessToken = "H4sIAAAAAAAEACVWtw7siBH7l9fKgLK0MnCFcs5ZnVY553jwv3vPrqYZEAMSHPLvP1b69FOa__n3H1VpizEWuN3wP9tI4UBCi5cqh8gI8f77-iWUdLE_sVy2eTp4ZUp7up9b8lXqQp07ZSDoKKPM3-le_m4Aj56avZBRRpm9M54fVVmAJThJu-WyuKzpiandV94XF6tAw_c53zvOEgWW68Gp-r0Ca9PcYVVmtJFNzAQjALxKn4Rvv8shCflWfQ0GGGUBRybQoj3HVff1t8KmADWOhqfA59dL76wKeaZGGfDiNyN6tfMyJcC-YM5cH2HD6zpKzXtjujuEI-Orm9qWadVRuLyEae7zWK34amsw-e11PAeE905aqtHwJn6ryGVR7kW6odzqLIG2IgR3BmdASfzkHax19qoiAwKNakt8m6pHE65939rGVCmsiu6h0wVkq62GQszIOzT0huZEABlHn_5xgocfDVK8mQwuEEqNyFJoTbtvJNY2os8Z3rkRJixzk9zv7rKePT4gKlB0l-HIog9NpMJm08jMaG2hmPSTvGF9yptXYmeF4dSFXyrAFHm8vcPefR2igDw_rrOvHNKXugQ4WLT46axAly_7JF8phOPy2radSd8ouA118lX0Gk8mV2AtQ1W6CKYbTPQWtqbxxZoSXQuGmd3FAgWOxFuEOVoiXbi-WqyyFTFHgB9lcm9GOydTXOI5IgmtWbh1OXsKQWAAXNzWQi2aNN4uY9pxgtEhVeAfSqWpacSatqBNHSkNtl8TmZCmAXVd3mtwTuXP_kfN0nMvYcsxP3FsXU-jSWAqA8NSxLMzizI1LgqtyawI5EdsD64WY1ZY-lcKlJO7-QQtdcsgEk_adZQgbBZ4-gPh8EQNM1N8-IzrT-ptt96uT7qIjMydIGpig70abtfp3GpZNypin7CkCkwKMwtgjwKqAukh9wjT8Prg1HrjXfsjybAwsFYopCWpX0ywbPu-GhfLlvRYqUULyUWIo3T9aolBJRZozh5OjK_q7j7FYwWDfJ8QuOsOLtTDJLwaOJkvOaOpPrh7PtyIZ0zxeHYkIQMMDzv5-xNIVWNv9-6UbRechdFLMdvoKB7-4gOMqbHc0JinrkGx-IlqVqEfwstXzr8flxpwrKTPDx2h8ZwYP4exRPwBaH2ZhWs7Ws4wc3s-blHOEKLseyQfAX96k-BO8JhOng3k9MkQbMx5XGq8jkVU8ueobJHaihNorE3cgY3vjjsFbZCy1dUxGPzp6Trgd-b4PkKLUG7LLxFL1dGQFk2kEuNgoaNjhoC0JAyVfY4PW7k1qaaP4VtfXSfKB-lHwOk8UKTaT8dZgbQpXWBOE2n1eXQ6hAVDwUcIm5QiX7ouD0ZN8NuOl4BztsiGpQeDeGBjP017sVE1AYvxBRu1lNwOdlVccoA2ui3Nu6uPK7g2bbeisxIvtMbmfh2917esPuyBCaY6Jglt00GAUDorTR8g2fv0wcyB6yXf0IwuSlgzrMfw5VhWARNsJSbCxsZwjxAx6iPqQjUZWqX98HgIRhxDAxa8NAwbjyVKv-o4R5_a0lTLuXMW44NTvoqP8sVEN1yUwIOrWQbpVeHhTofvHyC6PxhM0lB5Uq4x64qeUynY3RA7a4Im6p_80YCgXpqmn_TZnqofIxcQz_2oAd6bDJR9UioSxOIbZAnmgSYtT5M6bJF13aGp47twOrl4jjvtbykrr6hOzmuWt9-T05R5cgcDSMvF8B2Nv4EHIuG-72WmzYOoFHbsFYksIOC3pDv3hKdOSZYVMDwJrBYeEesAKakFkG9J7giigyk-3N4sMD7cjCSqh1Ihhtjwt2puPdWkwcF-P4iMRCCuY-aJY_D3tW7trrfO-kKdvC2sNwKI3d3mjBxRCIYnAXFx4nzpx2GsE0rhmI_VvKpjjZeMg0dzKQjd2IcJgCaleLkXf49HYIQ_bBGQNlNFNDNnpRy1nwZ9AxdRoaHYiLtA9jhxYbF8mvv8rvQBPQavEgXxgYOoE-T4HqrOyrO6HOEqcEbhYHrBSP9xEj8UN708yrzLyCerh68II1t7JwquNKkp0P6sd8sGM_hUzFnKTlobqEvenOjQeI0nbplnWWfp54PXQz7S1z7yKo-Vr536nmYBsxkrs4kgU-jFDW7onsYYxdoljrnWWlq5DeQSYeB2BVtV2VAF8_3nGcAXB5WAAxeCc4XWEwgScPBW1HantkIAWMe0AM_AMMotiDtPCNhrejapVccCzOy__vzrD7s-8z6pxfOrHh0sWzsQ_yKgkIqC-Uy0tRVJ3zDkz5so5B6Ym77Ukwrfcr4pgf3YUMlWIn0CbODWt0Ry3wEjKuqkaZnFU2UotMe29R1Avci4S6PJPT8KiU4hVQMbk_k7lFfE7-djzaWPrq4a3DW0K7WQnAHEtMllquetjlq4IthcbI1ClxAROrSIJ2rXad6DqZ4xFw1sOp-ZteXpbQpmb4p6yBiiO70wVyjnMe6Ez7uomi_RnKeYi3_FpzkrcMd7K3mIT2EQv7m8CZUF6CESXMiX2fT9klO_2kmLOxf-i30e53rfnf0UzL6hLfEFNQEYUQJhBL7dp_ESpvGKGkWCaoFff3S_wBWYC0tL1V__o_mZ62KVgx_LhsEMo21ivMMKwS0kCP5L7v9vuU01pvuxFr-1LMLKfP8Ezso5bhqvFZ9SRaV5kUpvmVMIsbmWQo2yJsnni4_MTcLZU7u6-LrW_k94B22_9SINTNcRgjtdAUkkXciOF7cavl5Sg1HnF15IAlm-KQMwrgcdS6i1bTihbkgiaUnTRnGskRCSnIYQVchI-v3a5PQscPkLdQZ2JiSLyIRsnEc5CAaEFWtv2uD2K6KcR18u_KmlXlEvIB3Krz6Uvx_14rAWw-reYnosdzSCmuFom09wmSHm9QXg4wdC3hDWwJukBkQgo6k9Rg0EIh7hOVhZFiGPzI5ggI7YZz-gJlTBtZQMr2o6zz_w_XC2DI9TSIvymGPZpQea-n4giWf6aPuH5v_8FyiejYBuCwAA";

// Read embed URL from textbox
var txtEmbedUrl = "https://app.powerbi.com/dashboardEmbed?dashboardId=b5f50796-6e97-4dc5-a755-00cf4405e029&groupId=be8908da-da25-452e-b220-163f52476cdd&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLU5PUlRILUNFTlRSQUwtcmVkaXJlY3QuYW5hbHlzaXMud2luZG93cy5uZXQifQ%3d%3d";

// Read dashboard Id from textbox
var txtEmbedDashboardId = "b5f50796-6e97-4dc5-a755-00cf4405e029";

// Read embed type from radio
var tokenType = "1";

// Get models. models contains enums that can be used.
var models = window['powerbi-client'].models;

// Embed configuration used to describe the what and how to embed.
// This object is used when calling powerbi.embed.
// This also includes settings and options such as filters.
// You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
var config = {
    type: 'dashboard',
    tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
    accessToken: txtAccessToken,
    embedUrl: txtEmbedUrl,
    id: txtEmbedDashboardId,
    pageView: 'fitToWidth'
};

// Get a reference to the embedded dashboard HTML element
var dashboardContainer = $('#dashboardContainer')[0];

// Embed the dashboard and display it within the div container.
var dashboard = powerbi.embed(dashboardContainer, config);

// Dashboard.off removes a given event handler if it exists.
dashboard.off("loaded");

// Dashboard.on will add an event handler which prints to Log window.
dashboard.on("loaded", function() {
    Log.logText("Loaded");
});

dashboard.on("error", function(event) {
    Log.log(event.detail);

    dashboard.off("error");
});

dashboard.off("tileClicked");
dashboard.on("tileClicked", function(event) {
    Log.log(event.detail);
 });